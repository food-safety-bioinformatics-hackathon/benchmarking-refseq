Jun-17 17:22:10.915 [main] DEBUG nextflow.cli.Launcher - $> nextflow run main.nf --sim 2
Jun-17 17:22:11.011 [main] INFO  nextflow.cli.CmdRun - N E X T F L O W  ~  version 19.04.1
Jun-17 17:22:11.019 [main] INFO  nextflow.cli.CmdRun - Launching `main.nf` [spontaneous_jepsen] - revision: 4fbc825d20
Jun-17 17:22:11.034 [main] DEBUG nextflow.config.ConfigBuilder - Found config local: /usr/users/QIB_fr005/deolivl/Academic/Quadram/014.hackaton2019/benchmarking-refseq/nextflow.config
Jun-17 17:22:11.035 [main] DEBUG nextflow.config.ConfigBuilder - Parsing config file: /usr/users/QIB_fr005/deolivl/Academic/Quadram/014.hackaton2019/benchmarking-refseq/nextflow.config
Jun-17 17:22:11.058 [main] DEBUG nextflow.config.ConfigBuilder - Applying config profile: `standard`
Jun-17 17:22:11.440 [main] DEBUG nextflow.Session - Session uuid: 608e8c15-bc1a-49c8-b4b6-815d478afdc3
Jun-17 17:22:11.440 [main] DEBUG nextflow.Session - Run name: spontaneous_jepsen
Jun-17 17:22:11.442 [main] DEBUG nextflow.Session - Executor pool size: 8
Jun-17 17:22:11.489 [main] DEBUG nextflow.cli.CmdRun - 
  Version: 19.04.1 build 5072
  Modified: 03-05-2019 12:29 UTC (13:29 BST)
  System: Linux 4.15.0-51-generic
  Runtime: Groovy 2.5.6 on OpenJDK 64-Bit Server VM 11.0.1+13-LTS
  Encoding: UTF-8 (UTF-8)
  Process: 2357@n114312.nbi.ac.uk [127.0.1.1]
  CPUs: 8 - Mem: 15.5 GB (5.9 GB) - Swap: 91 MB (91 MB)
Jun-17 17:22:11.520 [main] DEBUG nextflow.Session - Work-dir: /usr/users/QIB_fr005/deolivl/Academic/Quadram/014.hackaton2019/benchmarking-refseq/work [ext2/ext3]
Jun-17 17:22:11.615 [main] DEBUG nextflow.Session - Session start invoked
Jun-17 17:22:11.618 [main] DEBUG nextflow.processor.TaskDispatcher - Dispatcher > start
Jun-17 17:22:11.620 [main] DEBUG nextflow.script.ScriptRunner - > Script parsing
Jun-17 17:22:11.801 [main] DEBUG nextflow.script.ScriptRunner - > Launching execution
Jun-17 17:22:11.825 [PathVisitor-1] DEBUG nextflow.file.PathVisitor - files for syntax: glob; folder: /media/deolivl/QIB_deolivl/bigdata/noplasmids/; pattern: *.gz; options: [:]
Jun-17 17:22:11.947 [main] DEBUG nextflow.processor.ProcessFactory - << taskConfig executor: null
Jun-17 17:22:11.947 [main] DEBUG nextflow.processor.ProcessFactory - >> processorType: 'local'
Jun-17 17:22:11.955 [main] DEBUG nextflow.executor.Executor - Initializing executor: local
Jun-17 17:22:11.957 [main] INFO  nextflow.executor.Executor - [warm up] executor > local
Jun-17 17:22:11.960 [main] DEBUG n.processor.LocalPollingMonitor - Creating local task monitor for executor 'local' > cpus=8; memory=15.5 GB; capacity=8; pollInterval=100ms; dumpInterval=5m
Jun-17 17:22:11.964 [main] DEBUG nextflow.processor.TaskDispatcher - Starting monitor: LocalPollingMonitor
Jun-17 17:22:11.964 [main] DEBUG n.processor.TaskPollingMonitor - >>> barrier register (monitor: local)
Jun-17 17:22:11.966 [main] DEBUG nextflow.executor.Executor - Invoke register for executor: local
Jun-17 17:22:11.997 [main] DEBUG nextflow.Session - >>> barrier register (process: simulation)
Jun-17 17:22:12.005 [main] DEBUG nextflow.processor.TaskProcessor - Creating *combiner* operator for each param(s) at index(es): [1]
Jun-17 17:22:12.018 [main] DEBUG nextflow.processor.TaskProcessor - Creating operator > simulation -- maxForks: 8
Jun-17 17:22:12.043 [main] DEBUG nextflow.processor.ProcessFactory - << taskConfig executor: null
Jun-17 17:22:12.043 [main] DEBUG nextflow.processor.ProcessFactory - >> processorType: 'local'
Jun-17 17:22:12.043 [main] DEBUG nextflow.executor.Executor - Initializing executor: local
Jun-17 17:22:12.044 [main] DEBUG nextflow.Session - >>> barrier register (process: refseq_masher_reads)
Jun-17 17:22:12.045 [main] DEBUG nextflow.processor.TaskProcessor - Creating operator > refseq_masher_reads -- maxForks: 8
Jun-17 17:22:12.048 [main] DEBUG nextflow.processor.ProcessFactory - << taskConfig executor: null
Jun-17 17:22:12.049 [main] DEBUG nextflow.processor.ProcessFactory - >> processorType: 'local'
Jun-17 17:22:12.049 [main] DEBUG nextflow.executor.Executor - Initializing executor: local
Jun-17 17:22:12.050 [main] DEBUG nextflow.Session - >>> barrier register (process: find_GCF)
Jun-17 17:22:12.050 [main] DEBUG nextflow.processor.TaskProcessor - Creating operator > find_GCF -- maxForks: 8
Jun-17 17:22:12.059 [main] DEBUG nextflow.processor.ProcessFactory - << taskConfig executor: null
Jun-17 17:22:12.059 [main] DEBUG nextflow.processor.ProcessFactory - >> processorType: 'local'
Jun-17 17:22:12.059 [main] DEBUG nextflow.executor.Executor - Initializing executor: local
Jun-17 17:22:12.060 [main] DEBUG nextflow.Session - >>> barrier register (process: get_coverage)
Jun-17 17:22:12.068 [main] DEBUG nextflow.processor.TaskProcessor - Creating operator > get_coverage -- maxForks: 8
Jun-17 17:22:12.072 [main] DEBUG nextflow.script.ScriptRunner - > Await termination 
Jun-17 17:22:12.072 [main] DEBUG nextflow.Session - Session await
Jun-17 17:22:12.195 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jun-17 17:22:12.200 [Task submitter] INFO  nextflow.Session - [c2/0bd2b6] Submitted process > simulation (1005)
Jun-17 17:22:12.214 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jun-17 17:22:12.215 [Task submitter] INFO  nextflow.Session - [0f/43b646] Submitted process > simulation (1004)
Jun-17 17:22:12.747 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 2; name: simulation (1005); status: COMPLETED; exit: 0; error: -; workDir: /usr/users/QIB_fr005/deolivl/Academic/Quadram/014.hackaton2019/benchmarking-refseq/work/c2/0bd2b61552959687a0131a36ec9c5a]
Jun-17 17:22:12.763 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jun-17 17:22:12.764 [Task submitter] INFO  nextflow.Session - [68/412801] Submitted process > refseq_masher_reads (1)
Jun-17 17:22:12.831 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 1; name: simulation (1004); status: COMPLETED; exit: 0; error: -; workDir: /usr/users/QIB_fr005/deolivl/Academic/Quadram/014.hackaton2019/benchmarking-refseq/work/0f/43b646dbcae221a0bc836589bdc717]
Jun-17 17:22:12.838 [Actor Thread 6] DEBUG nextflow.Session - <<< barrier arrive (process: simulation)
Jun-17 17:22:12.841 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jun-17 17:22:12.842 [Task submitter] INFO  nextflow.Session - [70/6379ba] Submitted process > refseq_masher_reads (2)
Jun-17 17:22:46.238 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 4; name: refseq_masher_reads (2); status: COMPLETED; exit: 0; error: -; workDir: /usr/users/QIB_fr005/deolivl/Academic/Quadram/014.hackaton2019/benchmarking-refseq/work/70/6379bacf7a08dc52c6688d280eaf23]
Jun-17 17:22:46.248 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jun-17 17:22:46.248 [Task submitter] INFO  nextflow.Session - [51/5d5915] Submitted process > find_GCF (1)
Jun-17 17:22:46.299 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 5; name: find_GCF (1); status: COMPLETED; exit: 0; error: -; workDir: /usr/users/QIB_fr005/deolivl/Academic/Quadram/014.hackaton2019/benchmarking-refseq/work/51/5d5915669fe77021fcf25e748b7f45]
Jun-17 17:22:46.332 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jun-17 17:22:46.332 [Task submitter] INFO  nextflow.Session - [fd/b7773a] Submitted process > get_coverage (GCF_001865595.1_ASM186559v1_genomic.fna)
Jun-17 17:22:46.400 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 3; name: refseq_masher_reads (1); status: COMPLETED; exit: 0; error: -; workDir: /usr/users/QIB_fr005/deolivl/Academic/Quadram/014.hackaton2019/benchmarking-refseq/work/68/412801a4b49559fe43479d60a11126]
Jun-17 17:22:46.402 [Actor Thread 7] DEBUG nextflow.Session - <<< barrier arrive (process: refseq_masher_reads)
Jun-17 17:22:46.406 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jun-17 17:22:46.406 [Task submitter] INFO  nextflow.Session - [fe/a56439] Submitted process > find_GCF (2)
Jun-17 17:22:46.444 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 7; name: find_GCF (2); status: COMPLETED; exit: 0; error: -; workDir: /usr/users/QIB_fr005/deolivl/Academic/Quadram/014.hackaton2019/benchmarking-refseq/work/fe/a56439c294fcef620ed93c118b4615]
Jun-17 17:22:46.446 [Actor Thread 7] DEBUG nextflow.Session - <<< barrier arrive (process: find_GCF)
Jun-17 17:22:46.453 [Task submitter] DEBUG nextflow.executor.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jun-17 17:22:46.454 [Task submitter] INFO  nextflow.Session - [03/cf40c6] Submitted process > get_coverage (GCF_001865595.1_ASM186559v1_genomic.fna)
Jun-17 17:23:03.354 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 6; name: get_coverage (GCF_001865595.1_ASM186559v1_genomic.fna); status: COMPLETED; exit: 0; error: -; workDir: /usr/users/QIB_fr005/deolivl/Academic/Quadram/014.hackaton2019/benchmarking-refseq/work/fd/b7773a4a850767add79314dbcc8aa3]
Jun-17 17:23:03.355 [Task monitor] DEBUG nextflow.processor.TaskProcessor - Process `get_coverage (GCF_001865595.1_ASM186559v1_genomic.fna)` is unable to find [UnixPath]: `/usr/users/QIB_fr005/deolivl/Academic/Quadram/014.hackaton2019/benchmarking-refseq/work/fd/b7773a4a850767add79314dbcc8aa3/debug_1005.csv` (pattern: `debug_1005.csv`)
Jun-17 17:23:03.372 [Task monitor] ERROR nextflow.processor.TaskProcessor - Error executing process > 'get_coverage (GCF_001865595.1_ASM186559v1_genomic.fna)'

Caused by:
  Missing output file(s) `debug_1005.csv` expected by process `get_coverage (GCF_001865595.1_ASM186559v1_genomic.fna)`

Command executed:

  typeset -i count=0
  for gcf in `cat ${tophits}`; do
    if [ $count -gt 50 ]; then 
      echo "bubu" >> debug_1005.csv
      break;
    else
      HITREF=`\ls /media/deolivl/QIB_deolivl/bigdata/noplasmids/${gcf}*`
      if test x"${HITREF}" != x""; then
        echo ${HITREF} >> debug_1005.csv
        count=$count+1
        bwa index ${HITREF}
        bwa mem ${HITREF} sim_GCF_001865595.1_ASM186559v1_genomic.fna_1005_1.fq sim_GCF_001865595.1_ASM186559v1_genomic.fna_1005_2.fq | samtools view -S -b - | samtools sort > sort.bam
        bamcov -H sort.bam >> scores.csv
      fi  # if HITREF exists
    fi    # if count == 10
  done
  bwa index GCF_001865595.1_ASM186559v1_genomic.fna.gz
  bwa mem GCF_001865595.1_ASM186559v1_genomic.fna.gz sim_GCF_001865595.1_ASM186559v1_genomic.fna_1005_1.fq sim_GCF_001865595.1_ASM186559v1_genomic.fna_1005_2.fq | samtools view -S -b - | samtools sort > sort.bam
  bamcov -H sort.bam >> scores.csv
  score.py scores.csv > final_scores_GCF_001865595.1_ASM186559v1_genomic.fna_1005.csv

Command exit status:
  0

Command output:
  (empty)

Command error:
  .command.sh: line 3: tophits: unbound variable
  [bwa_index] Pack FASTA... 0.02 sec
  [bwa_index] Construct BWT for the packed sequence...
  [bwa_index] 0.40 seconds elapse.
  [bwa_index] Update BWT... 0.01 sec
  [bwa_index] Pack forward-only FASTA... 0.01 sec
  [bwa_index] Construct SA from BWT and Occ... 0.13 sec
  [main] Version: 0.7.17-r1188
  [main] CMD: bwa index GCF_001865595.1_ASM186559v1_genomic.fna.gz
  [main] Real time: 0.621 sec; CPU: 0.568 sec
  [M::bwa_idx_load_from_disk] read 0 ALT contigs
  [M::process] read 66668 sequences (10000200 bp)...
  [M::process] read 66668 sequences (10000200 bp)...
  [M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (0, 32148, 0, 0)
  [M::mem_pestat] skip orientation FF as there are not enough pairs
  [M::mem_pestat] analyzing insert size distribution for orientation FR...
  [M::mem_pestat] (25, 50, 75) percentile: (465, 499, 532)
  [M::mem_pestat] low and high boundaries for computing mean and std.dev: (331, 666)
  [M::mem_pestat] mean and std.dev: (498.66, 49.59)
  [M::mem_pestat] low and high boundaries for proper pairs: (264, 733)
  [M::mem_pestat] skip orientation RF as there are not enough pairs
  [M::mem_pestat] skip orientation RR as there are not enough pairs
  [M::mem_process_seqs] Processed 66668 reads in 4.899 CPU sec, 4.847 real sec
  [M::process] read 66664 sequences (9999600 bp)...
  [M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (0, 32152, 0, 0)
  [M::mem_pestat] skip orientation FF as there are not enough pairs
  [M::mem_pestat] analyzing insert size distribution for orientation FR...
  [M::mem_pestat] (25, 50, 75) percentile: (465, 499, 533)
  [M::mem_pestat] low and high boundaries for computing mean and std.dev: (329, 669)
  [M::mem_pestat] mean and std.dev: (499.02, 49.98)
  [M::mem_pestat] low and high boundaries for proper pairs: (261, 737)
  [M::mem_pestat] skip orientation RF as there are not enough pairs
  [M::mem_pestat] skip orientation RR as there are not enough pairs
  [M::mem_process_seqs] Processed 66668 reads in 4.959 CPU sec, 4.869 real sec
  [M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (0, 32161, 0, 0)
  [M::mem_pestat] skip orientation FF as there are not enough pairs
  [M::mem_pestat] analyzing insert size distribution for orientation FR...
  [M::mem_pestat] (25, 50, 75) percentile: (464, 498, 533)
  [M::mem_pestat] low and high boundaries for computing mean and std.dev: (326, 671)
  [M::mem_pestat] mean and std.dev: (498.53, 49.91)
  [M::mem_pestat] low and high boundaries for proper pairs: (257, 740)
  [M::mem_pestat] skip orientation RF as there are not enough pairs
  [M::mem_pestat] skip orientation RR as there are not enough pairs
  [M::mem_process_seqs] Processed 66664 reads in 4.945 CPU sec, 4.897 real sec
  [main] Version: 0.7.17-r1188
  [main] CMD: bwa mem GCF_001865595.1_ASM186559v1_genomic.fna.gz sim_GCF_001865595.1_ASM186559v1_genomic.fna_1005_1.fq sim_GCF_001865595.1_ASM186559v1_genomic.fna_1005_2.fq
  [main] Real time: 14.948 sec; CPU: 14.887 sec

Work dir:
  /usr/users/QIB_fr005/deolivl/Academic/Quadram/014.hackaton2019/benchmarking-refseq/work/fd/b7773a4a850767add79314dbcc8aa3

Tip: view the complete command output by changing to the process work dir and entering the command `cat .command.out`
Jun-17 17:23:03.377 [Task monitor] DEBUG nextflow.Session - Session aborted -- Cause: Missing output file(s) `debug_1005.csv` expected by process `get_coverage (GCF_001865595.1_ASM186559v1_genomic.fna)`
Jun-17 17:23:03.393 [main] DEBUG nextflow.Session - Session await > all process finished
Jun-17 17:23:03.394 [main] DEBUG nextflow.Session - Session await > all barriers passed
Jun-17 17:23:03.396 [Task monitor] DEBUG n.processor.TaskPollingMonitor - <<< barrier arrives (monitor: local)
Jun-17 17:23:03.401 [main] WARN  n.processor.TaskPollingMonitor - Killing pending tasks (1)
Jun-17 17:23:03.416 [main] DEBUG nextflow.trace.StatsObserver - Workflow completed > WorkflowStats[succeedCount=6; failedCount=2; ignoredCount=0; cachedCount=0; succeedDuration=4m 29s; failedDuration=17s; cachedDuration=0ms]
Jun-17 17:23:03.584 [main] DEBUG nextflow.CacheDB - Closing CacheDB done
Jun-17 17:23:03.597 [main] DEBUG nextflow.script.ScriptRunner - > Execution complete -- Goodbye
